# Qwen Code ASPECTS Status

#2025-10-19 (Discovery XXXI)

- Refilled `section-core-engine-tests` four aspects `telemetry/sdk.test.ts`, `telemetry/loggers*.test.*`, `telemetry/uiTelemetry.test.ts` And `telemetry/qwen-logger/*.test.ts`, to capture the selection of OTLP exporters, event/metric logging, and the robustness of the QwenLogger queue to circular structures and overflows.
- Added `cli-prompt-processor-tests`, combining Vitest sets `argumentProcessor`, `atFileProcessor`, `injectionParser` And `shellProcessor`, which documents valid syntax `!{}`/`@{}` and requirements for confirmations in different approval modes.
- Expanded `section-cli-utils` aspect `cli-config-extension-tests`, covering migrations and hydration of variable extensions in temporary workspaces.
- Checks and synchronization: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json`, `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.tags.json`, `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`, `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json`, `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json`.
- Follow-up: ADIw for `cli-prompt` rose to 5.96, and `core-engine-tests` (10.41) and sections `telemetry`/`cli-utils` are still not related to the new test aspects - need to add cross-references to the basic telemetry and runtime aspects (for example, `telemetry-sdk`, `telemetry-loggers`, `cli-extension-loader`) to remove isolates and reduce ADIw. High ADIw for `cli-ui*`/`cli-utils` remain in force; For a plan for aggregating and linking UI aspects, see previous posts.

#2025-10-19 (Discovery XXX)

- Refilled `section-testing` six aspects according to Vitest-sets `config.test.ts`, `config.integration.test.ts`, `settings.test.ts`, `settingsSchema.test.ts`, `trustedFolders.test.ts` And `auth.test.ts`, capturing rules for conflicting flags, merging settings, migrations, and environment variable requirements.
- Added three aspects to `section-cli-ui-tests`covering hooks `useKeypress`, `useAutoAcceptIndicator` And `useGeminiStream`, to document insert processing, the approval mode cycle, and stream/undo orchestration.
- Expanded `section-telemetry` two test aspects (`telemetry.test.ts`, `clearcut-logger.test.ts`), confirming the OTEL SDK lifecycle and ClearcutLogger's replay/metadata behavior.
- Synchronized tags and checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json`, `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.tags.json`, `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json`, `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json`, `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`.
- Follow-up: ADIw remains above the threshold for `cli-runtime`, everyone `cli-ui*`, `cli-utils`, `test-utilities` And `testing`; new test aspects need to be linked to basic runtime/UI aspects (e.g. `useKeypress` ↔ `KeypressContext`, `useGeminiStream` ↔ `GeminiClient`, telemetry SDK ↔ `telemetry-sdk`) and continue the plan to group overloaded CLI UI sections. Separately, it is required to initiate the connection of test slices `settings*` with configuration aspects to reduce isolates.

#2025-10-19 (Discovery XXIX)

- Fixed `cli-prompt-at-file-processor`by describing how AtFileProcessor deploys `@{path}` in prompt, sends notifications to the UI when files are ignored, and leaves placeholders on errors so that slash commands rely on the behavior being tested.
- Added `cli-runtime-macos-seatbelt-profiles`, documenting in detail the six built-in seatbelt profiles (`permissive|restrictive` × `open|closed|proxied`) and their interaction with `sandbox.ts`/`SEATBELT_PROFILE`so that the macOS sandbox-exec pipeline is transparently described.
- Added a new tag to the tag catalog `macos`, synchronized counters and checks: `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`, `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json`, `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.tags.json`, `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json`, `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json`.
- Follow-up: `cli-runtime` And `cli-prompt` remain above the ADIw threshold (13.77 and 5.54) - you need to connect the seatbelt and prompt processors with other runtime aspects (for example, ShellExecutionService, approval hooks), and also continue the plan to resolve isolates in `cli-ui*`/`cli-utils`, noted in previous entries.

#2025-10-19 (Discovery XXVIII)

- Added `section-core-utils-tests` five aspects of `fileUtils`, `flashFallback.integration`, `gitIgnoreParser`, `ignorePatterns` And `subagentGenerator`, to fix binary detection checks, fallback to a flash model exclusively for OAuth, Git ignoring rules and a strict JSON contract for the subagent generator.
- Expanded `section-cli-ui-tests` seven Vitest-aspects (`ContextSummaryDisplay`, `HistoryItemDisplay`, `InputPrompt`, `LoadingIndicator`, `ModelStatsDisplay`, `SessionSummaryDisplay`, `ToolStatsDisplay`), connecting Ink components with contexts, streaming and metrics, which raises the sparsely populated section and makes UI coverage verifiable.
- Synchronized tags `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`; validated the database `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json`, `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.tags.json`, `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json`, `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json`.
- Follow-up: despite new tests, sections `cli-ui*`, `cli-ui-tests`, `test-utilities` And `testing` remain with high ADIw and many isolates; you need to associate UI tests with aspects `cli-ui`, `cli-runtime`, `cli-ui-hooks` And `test-utils` (for example, through stories/contexts and the services they check), and also outline a plan for aggregation of overloaded CLI UI sections.

#2025-10-19 (Discovery XXVII)

- Added section `cli-ui-tests` with 15 aspects of Vitest coverage of Ink components: checks of AuthDialog, FolderTrust, Model/ModelSwitch, OpenAIKeyPrompt, QwenOAuthProgress, SettingsDialog, ShellConfirmation and Tool* messages are recorded, as well as basic contexts (`KeypressContext`, `SessionContext`), RadioButtonSelect and MaxSizedBox. This closes gaps in UI test documentation and highlights specific UX guarantees.
- The only tag removed `sandboxing` in the new section (replaced by `security`) to not exceed the limit of unique tags and maintain a security connection.
- Tags recalculated `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`so that the directory reflects new links.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.tags.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json`.
- Follow-up: sections `cli-ui*`, `cli-ui-tests`, `cli-utils`, `testing` still exceed ADIw thresholds and contain isolates; It is required to associate UI tests with runtime/contexts (for example, through the mention of common services and hooks) and prepare an aggregation/refactoring plan for overloaded UI sections.

#2025-10-19 (Discovery XXVI)

- Chapter `cli-privacy` added aspect `cli-privacy-settings-tests`, fixing how `usePrivacySettings.test.ts` checks unfolding `LoggingContentGenerator`, processing of paid tariff and recording `setCodeAssistGlobalUserSetting`. This links the privacy flow to test guarantees.
- A tag has been added to all privacy-aspirants `privacy`, A `cli-hook-privacy-settings` got the mark `privacy`so that the directory stops signaling an unused tag and makes it easier to filter related entries.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.tags.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json` | `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`.
- Follow-up: ADIw at blocks `cli-ui*`, `cli-utils` And `testing` still well above the threshold; We need aspects that connect UI components with dialogs/hooks, and cross-links of tests to runtime services in order to display isolates from the report.

#2025-10-19 (Discovery XXV)

- Refilled `section-build-pipeline`: aspects about `packages/vscode-ide-companion/esbuild.js`, generator `scripts/generate-notices.js` and test `scripts/tests/get-release-version.test.js`to close the connection between VSCode companion builds and the release tag.
- Updated `openai-converter`: Describes cleaning up orphan tool calls and merging assistant messages before sending to OpenAI.
- New `cli-privacy-orchestration` connects `/privacy`, state `App.tsx` And `useDialogClose`, enhancing coverage of the sparse Privacy section.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.tags.json` | `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts` (directory still signals unused tag `privacy`) | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json`.
- Follow-up: ADIw `cli-privacy` decreased to 7.34 without isolates, but the entire block `cli-ui*`/`cli-utils` remains isolated; we need to link the privacy dialogue with UI contexts/utilities and an aggregation plan for overloaded CLI UI sections.

#2025-10-19 (Discovery XXIV)

- Expanded `section-linting`: added pro aspects `.prettierrc`/`.prettierignore`, `.yamllint.yml` and a VS Code companion ESLint profile to capture formatting and statistical analysis outside of the main flat config.
- Refilled `section-cli-zed` aspect about `Session.prompt`/`runTool`, describing response streaming, tool confirmations, and reading `@path` through `read_many_files`, which connects Zed with `ToolRegistry`.
- Retagged `cli-privacy-router`: tag added `cli-config`to highlight PrivacyNotice's dependence on `Config.getContentGeneratorConfig()`.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.tags.json` | `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts` (the directory reported an unused tag `privacy`) | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json`.
- Follow-up: `section-cli-zed` <=6 records remain, and ADIw sections `cli-ui-*` still going through the roof; we need to link the new linting and zed aspects to the CLI runtime/automation and continue aggregating UI hooks (see previous audit/ADI notes).

#2025-10-20 (Discovery XXIII)

- A new section has been created `linting` (Linting & Static Analysis) with three aspects: flat config generalized `eslint.config.js`, custom described `no-relative-cross-package-imports` guard and fixed npm scripts `lint*`so that the command has a verifiable entry point into static analysis.
- The tag catalog has been replenished `linting`, counters are synchronized `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.tags.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json`.
- Follow-up: audit emphasizes that `section-linting` currently contains only 3 entries (<=6), and ADIw in the UI/CLI sections remains high; we need to connect linting aspects with build/automation (for example, mention Makefile preflight and CI workflow), and also continue the plan to disaggregate and link overloaded CLI UI sections.

#2025-10-19 (Discovery XXII)

- Added 47 aspects and 3 sections: separated `core-engine-tests` (Gemini/OpenAI/Code Assist/MCP/Qwen service tests), `core-tool-tests` (fs/web/mcp tools) and `core-utils-tests` (search, tokenization, errors, memory, sandbox), and also enriched `cli-subagent-ui` 16 nuances of a master and manager. Additionally, 4 groups of CLI commands are documented (`help/docs/about`, auth/approval/privacy, memory/tools/stats, model/theme/compress) with reference to Vitest coverages.
- Contextual aspects have been moved (`cli-ui-session-stats`, `cli-ui-keypress-provider`, `cli-ui-overflow-provider`) V `cli-ui-contexts` for a consistent structure.
- Updated tag catalog: added `code-assist`, `memory`, `openai`, `security`, counters are synchronized `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts` | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json`.
- Follow-up: ADIw went off scale again (total 68.30) and highlighted the insulation `cli-ui-*`, `cli-utils`, `cli-runtime`as well as fresh `core-engine-tests-mcp-oauth` And `core-engine-tests-services`. We need cross-links between UI contexts/hooks/components and consumers (CLI runtime, Config, services), as well as bridges from test aspects to code (e.g. link `core-engine-tests-mcp-oauth` c `mcp` providers/CLI `/mcp` teams). After working out the connections, repeat ADI to reduce isolates and fix the aggregation plan for overloaded CLI UI sections (`cli-ui-hooks`, `cli-ui-utilities`, `cli-ui-components`, `cli-ui-messages`, `cli-ui-shared`).

#2025-10-19 (Discovery XXI)

- Added 50 aspects: new sections introduced `cli-ui-themes`, `cli-ui-dialogs`, `cli-ui-contexts`, `test-utilities`; all built-in palettes are described (ANSI/default/Ayu/GitHub/Dracula/Qwen/NoColor/Xcode), Theme class and proxy `semantic-colors`, new dialog state hooks (settings/editor/subagents), settings and streaming contexts, CLI/UI utilities (`textUtils`, `isNarrowWidth`, `useBracketedPaste`), auxiliary CLI and core test artifacts (Vitest configs, fs/mocks, MockTool, rate-limit simulator, package `@qwen-code/test-utils`), as well as core OpenAI and IDE Companion constants. SHA-256 was calculated for all sources.
- Updated tag catalog: added tag `theming`, counters are synchronized `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts` | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json`.
- Follow-up: fresh sections `cli-ui-contexts` And `cli-ui-dialogs` isolated for now (ADIw -> /29.55); historical gaps remain `cli-ui`, `cli-ui-utilities`, `cli-ui-hooks`, `cli-ui-components`, `cli-ui-messages`, `cli-ui-shared`, `cli-utils`, `cli-runtime`. Cross-references and common tags are needed (link contexts with `KeypressProvider`/`StreamingContext` consumers, dialog hooks with commands/Config, utilities with CLI runtime and core services). For `core-openai-timeouts` add a connection with the OpenAI provider and retry policies, separately take into account the aggregation plan for overloaded CLI UI sections.

#2025-10-19 (Discovery XX)

- Added 31 aspects: CLI hooks are covered (prompt completion, `@`/slash processors, Vim, focus, launch editor, auth, folder trust, git branch, logger), general UI layers (`theme-manager`, semantic tokens, model directory, terminal sizing, key matchers, console message buffer, screen line reader, quit confirmation), and core barrels (`codeAssist` generator, MCP prompt registry, subagents index, telemetry/event keys, OpenAI provider registry, memory formatter, `/memory` action). SHAs were calculated for all sources.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts` | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json`.
- Follow-up: `section-cli-ui-hooks` now contains 32 entries and is subject to audit/ADI warnings (new ones are isolated `cli-hook-launch-editor`, `cli-hook-loading-indicator`, `cli-hook-state-ref`, `cli-hook-vim-editing`, `cli-hook-focus-reporting`, `cli-hook-logger` etc.). You need to group hooks/utilities (possibly breaking them down into sub-sections or combining aspects), add cross-links with `cli-ui`, `cli-runtime`, `cli-ui-utilities`/`cli-ui-messages`,strengthen tags to reduce ADIw and remove isolates.

#2025-10-21 (Discovery XIX)

- Sections created `cli-ui-components`, `cli-ui-messages`, `cli-ui-shared` And `cli-subagent-ui`, 31 new aspects have been added: onboarding/settings/statistics of UI widgets, messages (Gemini, tool, status), common input elements (TextInput, RadioButtonSelect, MaxSizedBox, Colors) and the full TUI flow of subagents (creation, management, execution) have been recorded.
- Added supporting CLI artifacts: documented `/corgi`, patch `is-in-ci` and contract `ICommandLoader`; added to core entries about batch barrels, model constants, ToolNames, `exit_plan_mode`, MCP tool bridge, diff metrics, file search caches, request tokenizer, Qwen RUM schemes and test `makeFakeConfig`.
- Teams: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts` | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json`.
- Follow-up: new UI sections are isolated for now (ADIw -> inf) - a connection with existing ones is needed `cli-ui`, `cli-ui-hooks`, `cli-ui-utilities`, as well as common tags/cross-references for CLI runtimes and services to reduce ADIw and remove isolates.

#2025-10-19 (Discovery XVIII)

- Added 4 aspects to `section-cli-prompt`: recorded `PromptRegistry` (de-duplication of MCP prompts), system prompt with `GEMINI_SYSTEM_MD`/`GEMINI_WRITE_SYSTEM_MD`, as well as compression and design summary prompts from `core/prompts.ts` to document internal CLI instructions.
- Tags are synchronized: `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json`.
- Follow-up: ADIw remains high for CLI subsystems (`cli-ui`, `cli-ui-hooks`, `cli-ui-utilities`, `cli-utils`, `cli-runtime`), it is necessary to connect UI/utility aspects with new prompts and runtime (for example, through prompting/context-management tags) and work out cross-references to display isolated records.

#2025-10-20 (Discovery XVII)

- Added 15 aspects to `section-cli-ui-hooks`: documented `useGeminiStream`, `useReactToolScheduler`, automatic switching of vision models, history/message queue, shell components and UX hooks (`Shift+Tab` for approval, welcome-back, kitty protocol).
- `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json` (log: `tmp/adi-qwen-code-2025-10-20-hooks.log`).
- Follow-up: ADIw continues to be high, new records have appeared among isolates (`cli-hook-auto-accept-indicator`, `cli-hook-input-history`, `cli-hook-kitty-protocol`). You need to link them to existing UX aspects (for example, through CLI UI utilities/commands sections) or extend the tags to improve coherence.

#2025-10-19 (Discovery XVI)

- Added 48 aspects: new sections are designed `IDE Integration Tests`, `MCP Integration Tests`, `Subagent Tests`, `Core Utility Tests – Filesystem`, `Core Utility Tests – Diagnostics`, `VS Code Companion Tests` And `Developer Tooling Tests`; supplemented `cli-ui-framework-tests`, `cli-ui-component-tests`, `cli-ui-utility-tests`, `core-tool-tests`, `telemetry-tests` And `core-engine-tests` fresh tests for UI, OpenAI pipeline, ls and subagents.
- Updated existing entries: `cli-ui-theme-definitions` now covers highlight.js themes (Atom One, Ayu, Dracula, GitHub, Googlecode, Shades of Purple, Xcode); `core-barrel-exports` fixed with test plug `index.test.ts`; `core-tools-ls` tied to regression set `ls.test.ts`.
- Tags are synchronized: `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json` (log: `tmp/adi-qwen-code-2025-10-19-xvi.log`).
- Follow-up: `section-core-engine-tests` reached 25 entries - prepare a plan for separating OpenAI tests into a separate section in the next cycle; `section-core-utils-tests` still at maximum, continue migrating old utility tests to sub-sections; `section-cli-ui-hooks` (31 entries) requires revision and enlargement of topics.

#2025-10-19 (Discovery XV)

- Added 50 aspects: closed gaps in tests `use*` CLI UI hooks (22 entries), created new sections `CLI UI Hook Tests`, `CLI UI Utility Tests`, `CLI UI Framework Tests`, `CLI Utility Tests`, and also expanded `cli-ui-command-tests`, `cli-ui-component-tests`, `cli-command-tests`, `test-utilities` And `core-engine-tests` (cover Code Assist path). Command/helper hooks, utilities and Code Assist backend are now covered.
- Launched `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts` to recalculate tag statistics.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json` (log: `tmp/adi-qwen-code.log`).
- Follow-up: new section `section-cli-ui-framework-tests` contains 3 entries (<6) - in the next cycle, add coverages for the remaining components/validators of the UI framework.

#2025-10-19 (Discovery XIV)

- Added 50 aspects: `cli-zed` (10 entries about handshake, canceling prompts, resolving @path and confirming tools), `cli-privacy` (10 entries about `usePrivacySettings`, slash command `/privacy`, App overlay), `qwen-integration-tests` (PKCE, device flow, content generator and token manager), `core-services-tests` (FileDiscovery, LoopDetection, Shell/Git/ChatRecording), `telemetry-tests` (metrics, SDK, UI telemetry, QwenLogger, utils).
- Added tag `privacy`, is added to existing and new entries in the CLI Privacy section.
- Tags are synchronized: `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json` (log: `tmp/adi-qwen-code.log`).
- Follow-up: new test blocks (`core-services-tests`, `telemetry-tests`, `qwen-integration-tests`) remain isolated - you need to link them to production sections through tags/descriptions, and also continue to work to reduce ADIw in `cli-ui*` And `testing`.

#2025-10-19 (Discovery XIII)

- Added 50 aspects: sections expanded `cli-command-tests` (13 scripts for FileCommandLoader, MCP prompt loader, shell/argument processors, `/bug`, `/init`, `/mcp`, `/stats`, `terminal-setup`, `gemini` main and non-interactive modes) and `cli-ui-component-tests` (8 entries about FolderTrustDialog, InputPrompt, ModelSwitchDialog, Qwen OAuth UI and hooks `useGeminiStream` / `useCommandCompletion` / `useFolderTrust` / `useToolScheduler`). New sections created `core-engine-tests` (7 tests for GeminiClient, CoreToolScheduler, GeminiRequest and OpenAI providers), `qwen-integration-tests` (QwenContentGenerator, OAuth2, SharedTokenManager), `core-services-tests` (GitService, LoopDetectionService, FileSystemService, ShellExecutionService) and `telemetry-tests` (metrics, sdk, utils, uiTelemetry). Additionally replenished `core-tool-tests` (ripGrep, task, web-fetch, write-file), `core-utils-tests` (filesearch crawler/ignore, memoryImportProcessor, installationManager) and `testing` (Config, flashFallback, Storage).
- Tags are synchronized: `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` (expected warnings about >10 tags in `section-core-engine`, `section-core-tools`, `section-core-utils`; few in number `cli-zed`, `cli-privacy`; overload `cli-ui-hooks`) | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json` (global ADIw=81.45; new sections `core-engine-tests` ADIw=13.04, `core-services-tests` ADIw=28.68, `telemetry-tests` ADIw=6.54; test blocks `cli-command-tests` And `cli-ui-component-tests` added isolated records `cli-command-tests-gemini-main`, `cli-command-tests-noninteractive`, `cli-command-tests-validate-noninteractive-auth`, `cli-ui-component-tests-use-gemini-stream`, `cli-ui-component-tests-use-command-completion`, `core-engine-tests-logger`, `core-services-tests-loop-detection`, `core-services-tests-shell-execution` etc.).
- Follow-up: 1) associate new test aspects with the corresponding production records (`cli-runtime`, `cli-ui`, `cli-ui-components`, `core-engine`, `core-tools`, `qwen-integration`, `telemetry`, `core-services`) through cross-mentions or tags to reduce isolation; 2) consider aggregating records/reviews for sections `cli-ui-*` and a new block of tests, since ADIw there goes to infinity due to the lack of internal edges; 3) analyze how to combine test sections with integration ones (`testing`, `integration-tests`) or document coverage matrices to make the structure more cohesive; 4) at the next audit, pay attention to high ADIw in `core-services-tests` And `core-engine-tests` -- it might be worth adding explanatory notes with links to services/adapters.

#2025-10-19 (Discovery XII)

- Added 50 aspects: sections created `cli-command-tests` (8 entries about validators `/mcp` and command loaders), `cli-config-tests` (10 scenarios for `parseArguments`, `loadCliConfig`, extensions and key settings), `cli-ui-command-tests` (12 TUI commands: `/about`, `/chat`, `/memory`, `/tools`, `/docs` etc.), `cli-ui-component-tests` (6 components - AuthDialog, ContextSummaryDisplay, Header, ModelSelectionDialog, OpenAIKeyPrompt, SessionSummaryDisplay), `core-tool-tests` (7 tools - edit/glob/grep/memory/read-many-files/shell/web-search) and `core-utils-tests` (7 service modules - bfsFileSearch, environmentContext, retry, safeJsonParse, secure-browser-launcher, systemEncoding, workspaceContext). These posts close the gap on unit tests and help track the correspondence between UX/CLI and the kernel.
- Tags are synchronized: `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` (warnings: previous `section-core-engine`, `section-core-tools`, `section-core-utils` >10 tags; small `cli-zed`, `cli-privacy`; overloaded `cli-ui-hooks`; new `cli-ui-component-tests` =6 entries) | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json` (global ADIw=77.26; `cli-ui-command-tests` And `cli-ui-component-tests` while isolated `cli-command-tests`, `cli-config-tests`, `core-tool-tests`, `core-utils-tests` stay around 6-7).
- Follow-up: 1) add descriptions/tags of test records with links to relevant production aspects (`cli-ui`, `cli-ui-components`, `core-tools`, `cli-runtime`) to reduce ADIw; 2) link new unit tests to integration scenarios (`testing`, `integration-tests`) through reciprocal links or general tags; 3) work out the aggregation of overloaded UI sections (`cli-ui-framework`, `cli-ui-components`, `cli-ui-hooks`, `cli-ui-utilities`) and raise the filling `cli-zed`, `cli-privacy` to a safe threshold; 4) evaluate the possibility of combining test sections with existing test aspects to avoid further increases in isolation.

#2025-10-19 (Discovery XI)

- Added 24 aspects: new sections `dev-tooling` (7 posts about flat ESLint, Vitest, esbuild and NOTICES generation) and `test-utilities` (8 entries about makeFakeConfig, mockWorkspaceContext, MockTool, fs/promises mock, CLI test-setup and package `@qwen-code/test-utils`); existing sections have been supplemented (`cli-ui-components`, `cli-subagents-ui`, `core-utils`, `core-engine`, `ide-integration`, `telemetry`, `testing`, `cli-commands-support`) latest posts (`AsciiArt`, barrel exports of subagents, `formatMemoryUsage`, `core/openai` defaults, `QWEN_CODE_COMPANION_EXTENSION_NAME`, circular telemetry tests, orphaned tool calls fixture, alias `/refreshmemory`).
- Tags are synchronized: `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` (warnings remain: `section-core-engine`, `section-core-tools`, `section-core-utils` >10 tags; `cli-zed`, `cli-privacy` <=6 records; `cli-ui-hooks` =31 entries) | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json`.
- ADIw: globally 13.76 (ADIw 64.68). New sections `dev-tooling` (ADIw 32.09, isolated `dev-vscode-esbuild`, `dev-vscode-notices-generator`) And `test-utilities` (ADIw 6.24) require connections with existing `automation`/`testing`. New entries `core-openai-defaults` (isolate in `core-engine`) And `cli-ui-ascii-art` (isolate in `cli-ui-components`) were added to previously recorded areas (`cli-ui-*`, `cli-utils`, `cli-runtime`).
- Follow-up: 1) add cross-links/tags between `dev-tooling` and existing aspects `automation`, `build-system`, `testing`; 2) tie `test-utilities` records from `testing`/`integration-tests` (for example, through mention of specific tests); 3) update descriptions `core-openai-defaults`, `cli-ui-ascii-art`, `dev-vscode-esbuild`, `dev-vscode-notices-generator`so that they refer to related aspects and reduce isolation; 4) continue work on reducing ADIw for large UI sections (isolation remains, see entries from 2025-10-19 Discovery X).

#2025-10-19 (Discovery X)

- Added 50 aspects: `cli-ui-components` (+15) and `cli-ui-messages` (+6) close Ink components (Tips, ShowMoreLines, ToolStatsDisplay, ToolMessage, etc.); `cli-subagents-ui` (+14) covers master and subagent manager steps; `cli-ui-framework` (+6) fixes infrastructure (`MaxSizedBox`, `VimModeContext`, `useVim`, `editorSettingsManager`, `ui/types`, `ui/constants`); also added to the core (`core-tools`, `mcp-integration`, `telemetry`, `subagents`, `openai-integration`) new entries (`PromptRegistry`, `getMCPServerPrompts`, `tool-names`, `telemetry/index`, `EventMetadataKey`, `Qwen RUM event types`, `TokenStorage` contract, `subagents/index`, OpenAI providers).
- Tags are synchronized: `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` (same warnings: `section-core-engine`, `section-core-tools`, `section-core-utils` >10 tags; `cli-zed`, `cli-privacy` <=6 records; `cli-ui-hooks` =31 entries) | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json`.
- ADIw increased: globally 64.50; sections `cli-ui-framework` (1071.18, 19 isolates), `cli-ui-components` (204.16, 16 isolates), `cli-ui-messages` (166.11, 7 isolates), `cli-ui` (115.58, 13 isolates), `cli-ui-hooks` (141.96, 22 isolates), `cli-ui-utilities` (, 12 isolates), `cli-utils` (262.33, 15 isolates) and `cli-runtime` (35.03, 8 isolates) remain virtually unrelated.
- Follow-up: add cross-references (App.tsx, Config, ToolRegistry, CommandService) and common tags between newly added UI aspects and existing ones `cli-ui`, `cli-ui-hooks`, `cli-utils`, `core-tools`to reduce ADIw <5; consider the allocation of separate subsections/aggregation for `cli-ui-framework`/`cli-ui-utilities`; add connections `cli-runtime` records with configuration and services; prepare an expansion plan `cli-privacy`/`cli-zed` up to >=6 entries.

#2025-10-19 (Discovery IX)

- Added four sections: `cli-ui-framework` (16 aspects about themes, contexts and general controls), `cli-ui-components` (9 aspects about key Ink components), `cli-ui-messages` (5 aspects for rendering messages) and `cli-subagents-ui` (5 aspects for the UI of the master/subagent manager); in addition, entries for auxiliary utilities have been created (`cli-runtime`/`cli-utils`) and kernels (`core-config`, `core-services`, `core-tools`, `core-utils`), a total of 49 new aspects.
- Updated existing `cli-ui-formatters` (description added, `lastUpdated=2025-10-19`).
- Tags are synchronized: `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json`.
- ADIw remains high: new sections `cli-ui-framework` (inf), `cli-ui-components` (192.57), `cli-ui-messages` (60.09) and `cli-subagents-ui` (6.01) consist predominantly of isolated aspects; existing `cli-ui`, `cli-ui-hooks`, `cli-ui-utilities`, `cli-utils`, `cli-runtime` also preserve isolates.
- Follow-up: link new UI entries to neighboring sections (`cli-ui`, `cli-ui-hooks`, `cli-utils`, `core-tools`) through tags and cross-mentions (for example, in descriptions refer to `App.tsx`, `CommandService`, `ToolConfirmationMessage`); consider combining/re-dividing large groups (`cli-ui-*`) and a plan to reduce ADIw <5; expand coverage `cli-runtime` through links to configuration and services to remove 8 isolates.

#2025-10-19 (Discovery VIII)

- Added 41 new aspects for `cli-ui-hooks` (Gemini streams, command dialogs, terminal indicators, Auth/Qwen, git branch badge, etc.) and 13 aspects for `cli-prompt` (slash/`@`-completion, history, bracketed paste, prompt ghost text); 9 existing entries updated (`cli-privacy/*`, `cli-hook-keypress`, `cli-hook-workspace-migration`, `cli-hook-privacy-settings`, `cli-prompt-shell-processor`, `cli-prompt-injection-parser`) to actualize behavior.
- Tags are synchronized: `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json sync-counts`.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` (warnings: `section-core-tools` >10 tags; `section-cli-zed`, `section-cli-privacy` <=6 records; `section-cli-ui-hooks` =31 entries >25) | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json` -> total ADIw=51.74 (>5); locally: `cli-ui-hooks` ADIw=136.25 (22 isolates), `cli-ui` ADIw=110.22 (13 isolates), `cli-utils` ADIw=195.63 (13 isolates), `cli-ui-utilities` ADIw= (12 isolates), `cli-runtime` ADIw=31.03 (7 isolates), `cli-prompt` ADIw=5.66.
- Follow-up: fix the crushing plan `cli-ui-hooks` (31 entries) into subtopics and link new ones `use*`-hooks with adjacent sections (`cli-ui`, `cli-runtime`, `core-engine`) via tags/links; add cross-tags and cross-mentions for new ones `cli-prompt` aspects; raise the connections of isolates (`cli-ui`, `cli-ui-utilities`, `cli-utils`, `cli-runtime`) to Config/GeminiClient/CommandService and corresponding UI components to reduce ADIw <5; further consider expansion `cli-privacy` And `cli-zed` up to >6 entries or merging with wider sections.

#2025-10-20 (Discovery VII)

- Added 50 aspects: new sections introduced `openai-integration` (DashScope/DeepSeek/OpenRouter providers, pipeline, converters and telemetry), `cli-zed` (ACP transport, file service, agent), `cli-ui-utilities` (clipboard, terminal setup, Kitty, markdown split, console patcher, code colorizer), `cli-privacy` (three notice + router) and `cli-ui-hooks` (useKeypress/privacy/workspace migration); expanded `cli-commands-support` (`extensions` enable/disable/update/uninstall, `mcp remove`), `core-utils` (fatal errors, safe JSON helpers, git utils, YAML parser, tool matcher), `cli-utils` (variable hydrator) and `core-engine` (logger).
- Tags are synchronized: `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` (warnings: `section-core-tools` >10 tags; `section-cli-prompt`, `section-cli-zed`, `section-cli-privacy`, `section-cli-ui-hooks` <=6 entries) | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json` -> total ADIw=41.30 (>5); locally: `cli-runtime` ADIw=30.80 (7 isolates), `cli-utils` ADIw=184.40 (13 isolates), `cli-zed` ADIw=10.90 (isolate `cli-zed-filesystem`), `cli-ui-hooks` ADIw=8.29, `cli-ui-utilities` ADIw=6.03, `cli-prompt` ADIw=6.74.
- Follow-up: link isolates `cli-runtime`/`cli-utils`/`cli-zed`/`cli-ui-hooks` with new aspects through tags (`cli-runtime`, `cli-config`, `ide-integration`, `chat-engine`) and cross descriptions; evaluate the need to either enlarge or merge new sections of <=6 records (in particular `cli-zed`, `cli-privacy`, `cli-ui-hooks`) after additional materials become available; build a plan to reduce ADIw <5 (add connections with `Config`, `GeminiClient`, MCP/ToolRegistry and CLI UI sections, update tags for OpenAI and Zed materials).

#2025-10-19 (Discovery VI)

- Added 50 aspects: new sections created `cli-commands-core`, `cli-commands-support`, `cli-prompt`; expanded `cli-ui` (InputPrompt, Footer, Header, etc.) and `documentation` (CLI commands, token caching, MCP, subagents, deployment). Slash commands fixed `/chat`, `/memory`, `/model`, `/summary`, `/tools`, auxiliary `/about`, `/approval-mode`, `/setup-github`, `/vim` etc., as well as prompt pipeline handlers (`ShellProcessor`, `extractInjections`, contract `SlashCommand`).
- Added to the tag directory `cli-commands`; synchronization: `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` (warnings: `section-core-tools` >10 tags, `section-cli-prompt` =5 entries) | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json` -> total ADIw=39.43 (>5); `cli-prompt` ADIw=6.51, `cli-runtime` ADIw=30.11 with 7 isolates (old records), `cli-utils` ADIw=428.33 with 13 isolates.
- Follow-up: link "old" `cli-utils`/`cli-runtime` isolates with new aspects through refined tags (Config, CommandService, ShellExecutionService) and reciprocal links; consider adding cross tags for the section `cli-prompt`to reduce ADIw <5; at the next revision, check the need to aggregate `cli-utils` or break it down into subtopics.

## 2025-10-19 (Discovery V)

- Added 50 aspects: new section `cli-utils` (auto-update utilities, stdin reading, cleaning, git helpers), `core-foundations` (file/network/pty utilities, gitignore, filesearch) and `documentation` (architecture, sandbox, telemetry, checkpointing, triage). Expanded `build-pipeline` (`esbuild.config.js`, `clean.js`, `.aoneci/ci.yml`, Cloud Build) and `testing` (Vitest configs and setup for core and scripts).
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` (warnings: `section-core-tools` >10 tags, `section-documentation` contains 5 records <=6) | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json` -> total ADIw=35.80 ( >5), section `cli-utils` ADIw=337.50 with 13 isolates, `cli-runtime` ADIw=28.72.
- Tags are synchronized: `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`.
- Follow-up: link new CLI utilities with existing aspects (`Config`, `GeminiClient`, `CommandService`) through refined tags/descriptions to remove isolates and reduce ADIw; evaluate the filling `section-documentation` (<=6 entries) and at the next iteration add links to update/release processes.

## 2025-10-19 (Discovery V)

- Added 50 aspects for test coverages: expanded `core-utils-tests` (filesearch, tokenizers, shell utils), `core-engine-tests` (Gemini chat, OpenAI pipeline, prompts), `core-tool-tests` (MCP, read-file, plan/todo), `cli-ui-command-tests` (clear/compress/copy/restore/setupGithub/theme, etc.) and `cli-ui-component-tests` (footer, loading indicator, settings dialog, text-buffer). All SHAs are counted and sources link to specific TypeScript/TSX test files.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` (warnings: `section-core-engine`, `section-core-tools`, `section-core-utils` use >10 tags, `section-cli-ui-hooks` contains 31 entries) | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json` -> total ADIw=86.09 ( >5), sections `cli-ui-command-tests`, `cli-ui-component-tests` and several CLI/UI groups have ADIw=inf due to new isolated tests.
- Tags are synchronized: `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`; a new tag has been added to the catalog `prompting`.
- Follow-up: link new test aspects to the corresponding production nodes (`GeminiClient`, `SettingsDialog`, `CommandService`, `ToolRegistry`, `TextBuffer`) through refined tags and descriptions to remove isolates in the CLI/UI sections and reduce ADIw; Consider grouping repetitive CLI UI tests into aggregates to reduce the number of isolated records.

## 2025-10-19 (Discovery IV)

- Added 50 aspects for assembly scripts (`Makefile`, Dockerfile, build/check/warn JS utilities), MCP client (transport, OAuth auto-configuration, RUM), integration tests (CLI files/memory/shell, IDE client, web search), subagents (run loop, generator, types) and telemetry (constants, file-exporters, event classes). There are no empty sections left; expanded `build-pipeline`, `mcp-integration`, `integration-tests`, `subagents`, `telemetry`.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` (warning: `section-core-tools` uses >10 unique tags) | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json` -> total ADIw=24.95 ( >5), section `core-engine` ADIw=5.31; There are no isolates.
- Tags are synchronized: `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`.
- Follow-up: reduce ADIw `core-engine`, linking new Telemetry/Subagent/Build aspects to the core (`GeminiClient`, `Config`, `ToolRegistry`), and prepare a separate review on the expanded `core-tools` taxonomies (>10 unique tags).

## 2025-10-18 (Discovery III)

- Added 50 aspects and created new sections `cli-ui`, `automation`, `integration-tests`, `core-utils`, `mcp-integration`: TUI contexts/components, assembly and telemetry node scripts, Terminal Bench configurations and tasks, core utilities (retry, quota, search, tokenizers) and OAuth/MCP CLI commands are covered. SHAs were calculated for all sources and tags were added to the dictionary `automation`, `core-utils`, `integration-tests`.
- Tags are synchronized: `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` (expected warnings: sections <=6 entries, `core-tools` with >10 tags) | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json` -> total ADIw=34.07 (significantly above the threshold). Isolates: `cli-app-shell`, `cli-builtin-command-loader`, `cli-command-service`, `cli-extensions-command`, `cli-file-command-loader`, `cli-key-bindings`, `cli-validate-noninteractive-auth`, `context-image-tokenizer`, `context-message-inspectors`, `context-project-summary`, `context-quota-guard`, `context-request-tokenizer`.
- Follow-up: link new TUI/automation/core-utils aspects to existing cores (`App.tsx`, `GeminiClient`, `Config`, `ToolRegistry`) and describe where tokenizers/scripts are used to remove isolates and reduce ADIw.

## 2025-10-18

- Knowledge base initialized: sections added `cli-runtime` And `core-engine` with the first aspects about launching the CLI, the Config core and GeminiClient (focus on launching in a sandbox, registering tools and context compression).
- Expansion: added pro aspects `SandboxConfig` + `start_sandbox` (container selection control and PATH/port reassembly), `ToolRegistry` (orchestration project/MCP discovery), `ShellExecutionService` (single implementation `node-pty`/`child_process` for CLI/sandbox), `WorkspaceContext` (multi-root boundaries), `FileDiscoveryService` (git/.qwenignore filtering), `memoryDiscovery` (global/project memory, import and filtering), `runNonInteractive` + `executeToolCall` (streaming CLI mode over GeminiClient/CoreToolScheduler), `loadCliConfig`→`core Config` (preparing sandbox/memory/tool parameters before creating the kernel) and a new section `context-pipelines` (includeDirectoriesmemory/workspace, sandbox shellShellExecutionService, MCP discovery chain, non-interactive reuse `Config`) plus aspect `core-tooling-bridge`, connecting ToolRegistry and GeminiClient - we fix the runtime  core framework.
- Audit: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` -> section warnings <=6 entries expected; we continue to replenish `cli-runtime` And `core-engine`.
- ADI: `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json` -> ADIw=3.71 (general network is normal); section `core-engine` now 4.50 (isolate only `core-shell-execution-service`, linked to ToolScheduler via shell tool). The next step is to further describe the ShellExecutionService  declarative tools  surrounding services chain in order to remove the last isolate and continue to expand the context pipelines.
- Tags are synchronized: `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`.
- Extension (Qwen auth): added section `qwen-integration` with aspects about `qwenOAuth2.ts` (device flow + PKCE), `sharedTokenManager.ts` (file lock and token cache) and `qwenContentGenerator.ts` (dynamic dashscope endpoint substitution). All linked by sources `projects/qwen-code/packages/core/src/qwen/*.ts`, tagged `qwen-auth` (added to catalog).
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts` | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json` (repeat after sync). The new section is isolated for now (ADIw=inf, three isolates), in the next update we need to fix connections with the CLI `/auth` and provider configuration to enable Qwen integration into the overall network.
- IDE Companion: section added `ide-integration` with aspects about activating the VSCode extension (`extension.ts`), MCP server (`ide-server.ts` + `open-files-manager.ts`) and diff cycle (`diff-manager.ts`); all tagged `ide-integration`, and the run command `qwen-code.runQwenCode` tied to `cli-runtime` for the IDE -> CLI bridge.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts` | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json` -> ADIw=6.30 (threshold 5.0 exceeded due to old isolates `core-shell-execution-service`, `context-sandbox-shell` and fresh section). Follow-up: further link IDE aspects to the kernel (for example, describe the use `ide/diffAccepted` in the CLI tool loop or export workspace variables to Config) to reduce ADIw below the threshold and display `context-sandbox-shell` from isolates.

## 2025-10-18 (Discovery II)

- Added sections `core-tools`, `subagents`, `telemetry`, `build-pipeline`, `testing`; expanded `core-engine` And `cli-runtime` (total +51 aspects) with a focus on declarative tools, subagent manager services, telemetry, assembly pipeline and Vitest infrastructure.
- Tags: catalog updated (`build-system`, `core-tools`, `metrics`, `subagents`, `telemetry`, `testing`, `web`, etc.), counters are synchronized `python3 aspects/scripts/tags_manager.py --tags-path aspects/projects/qwen-code/ASPECTS.tags.json --aspects-path aspects/projects/qwen-code/ASPECTS.json sync-counts`.
- Checks: `python3 -m json.tool aspects/projects/qwen-code/ASPECTS.json` | `python3 aspects/scripts/audit.py aspects/projects/qwen-code/ASPECTS.json` (expected section warnings <=6 entries for new sections) | `python3 aspects/scripts/adi.py aspects/projects/qwen-code/ASPECTS.json --per-section --weighted --ignore-tag-frac 0.15 --include-slug-links --include-source-links --adi-threshold 5.0 --show-isolates --isolate-limit 20 --tags-catalog aspects/projects/qwen-code/ASPECTS.tags.json` -> total ADIw increased to 26.48 (5 isolates), locally: `cli-runtime` ADIw=15.86 (isolated `cli-builtin-command-loader`, `cli-command-service`, `cli-extensions-command`, `cli-file-command-loader`, `cli-validate-noninteractive-auth`), `core-tools` ADIw=20.97 (isolated `core-tools-mcp-client-manager`, `core-tools-shell-tool`, `core-tools-task`, `core-tools-tool-registry`, `core-tools-tools-base`). It is necessary to link new CLI and tool aspects with existing ones (for example, through `core/coreToolScheduler.ts`, `ToolRegistry`, CLI UI) and add cross-links to services/telemetry to reduce ADIw and remove isolates.
- Build & Release: documented `scripts/build.js`, `build_sandbox.js`, `prepare-package.js`, `start.js`, `Dockerfile`; SHA of all artifacts received, tag added `build-system`. The next step is to describe `Makefile` and CI scenarios for complete coverage.
- Testing: fixed Vitest configuration and global setup for integrations, plus terminal benchmarks; tag added `testing`. The plan is to link test aspects with the appropriate tools (write/edit/shell) and sandbox config.
- Telemetry: new section with aspects of SDK, loggers, metrics, tool-call decisions and Clearcut; further linking with CLI and core tools (for example, Shell tool  FileOperationEvent) will be required in future iterations.
